@using System.Web.Mvc;
@using System.Web.Mvc.Html
@using System.Web.Routing
@using VocaDb.Model.DataContracts.Albums;
@using VocaDb.Web.Helpers;
@inherits VocaDb.Web.Code.HelperPage

@helper AlbumIconLink(AlbumContract album) {
	<a href="@Url.Action("Details", "Album", new { id = album.Id })">
		<img src="@Url.Action("CoverPictureThumb", "Album", new { id = album.Id })" alt="Cover" class="coverPicThumb" />
	</a>		
}

@helper AlbumList(IEnumerable<AlbumWithAdditionalNamesContract> albums, 
	bool displayRating, bool displayReleaseDate, bool displayType = false) {
	
	<table>
		@foreach (var album in albums) {
		<tr>
			<td>
				@AlbumIconLink(album)
			</td>
			<td>
				@Html.ActionLink(album.Name, "Details", "Album", new { id = album.Id }, new { title = album.AdditionalNames })
				@if (displayType) {
					@("(")@Translate.DiscTypeName(album.DiscType)@(")")
				}
				<br />
				<span class="extraInfo">@album.ArtistString</span>
				@if (displayReleaseDate && !album.ReleaseDate.IsEmpty) {
					<br />
					<span>@HelperRes.AlbumHelpersStrings.Released @album.ReleaseDate.Formatted</span>
	}
			</td>
	   </tr>
  }	
	</table>
		
}

@helper AlbumGrid(IEnumerable<AlbumWithAdditionalNamesContract> albums, int columns,
	bool displayRating, bool displayReleaseDate, bool displayType = false) {
	
	<table>
		@{ int i = 0; }
	
		@foreach (var album in albums) {
			if (i % columns == 0) {
				@Html.Raw("<tr>")
			}
			<td>
				@AlbumIconLink(album)
			</td>
			<td>
				@Html.ActionLink(album.Name, "Details", "Album", new { id = album.Id }, new { title = album.AdditionalNames })
				@if (displayType) {
					@("(")@Translate.DiscTypeName(album.DiscType)@(")")
				}
				<br />
				<span class="extraInfo">@album.ArtistString</span>
				@if (displayReleaseDate && !album.ReleaseDate.IsEmpty) {
					<br />
					<span>@HelperRes.AlbumHelpersStrings.Released @album.ReleaseDate.Formatted</span>
				}
			</td>
			{ i++; }
			if (i % columns == 0) {
				@Html.Raw("</tr>")
			}
		}
		@if (i % columns != 0) {
			@Html.Raw("</tr>")
		}
	</table>
			
}

@helper AlbumThumbs(IEnumerable<AlbumWithAdditionalNamesContract> albums) {
	
	<ul class="thumbnails">
		@foreach (var album in albums) {
		<li class="span2">
			<div class="thumbnail">
				<a href="@Url.Action("Details", "Album", new { id = album.Id })" class="coverPicThumb">
					<img src="@Url.Action("CoverPictureThumb", "Album", new { id = album.Id })" alt="Cover" />
				</a>
				<div class="caption">
					<h5>@album.Name</h5>					
				</div>
			</div>
		</li>
  }
	</ul>
	
}

@helper PrintArchivedAlbumData(int archivedEntryId, ArchivedAlbumContract data, int compareToEntryId, ArchivedAlbumContract compareToData) {

	<fieldset>
		<legend>Content</legend>
	
		<table>
			@ArchivedEntryHelpers.DataRow("Album Id", data.Id)
			@ArchivedEntryHelpers.PictureRow("Cover", Url.Action("ArchivedVersionCoverPicture", "Album", new { id = archivedEntryId }), 
				compareToEntryId != 0 ? Url.Action("ArchivedVersionCoverPicture", "Album", new { id = compareToEntryId }) : null)
			@ArchivedEntryHelpers.TranslatedNameRow(data.TranslatedName, compareToData != null ? compareToData.TranslatedName : null)
			@ArchivedEntryHelpers.DataRowList("Names", DataFormatUtils.GenerateHtmlFromHelper(data.Names, ArchivedEntryHelpers.NameInfo))
			@ArchivedEntryHelpers.DataRow("Description", data, compareToData, d => d.Description)
			@ArchivedEntryHelpers.DataRow("Disc type", data, compareToData,d => Translate.DiscTypeName(d.DiscType))
		    @ArchivedEntryHelpers.DataRow("Release date", data, compareToData, d => d.OriginalRelease != null && d.OriginalRelease.ReleaseDate != null ? ArchivedEntryHelpers.FormatReleaseDate(d.OriginalRelease.ReleaseDate) : string.Empty)
			@ArchivedEntryHelpers.DataRow("Catalog number", data, compareToData, d => d.OriginalRelease != null ? d.OriginalRelease.CatNum : string.Empty)
			@ArchivedEntryHelpers.DataRow("Release event", data, compareToData, d => d.OriginalRelease != null ? d.OriginalRelease.EventName : string.Empty)
			@ArchivedEntryHelpers.DataRowList("External links", data, compareToData, d => DataFormatUtils.GenerateHtmlFromHelper(d.WebLinks, ArchivedEntryHelpers.WebLinkInfo))
			@ArchivedEntryHelpers.DataRowList("Artists", data, compareToData, d => DataFormatUtils.GenerateHtml(d.Artists, artist => MvcHtmlString.Create(artist.NameHint + " [" + artist.Id + "] - IsSupport: " + artist.IsSupport + ", Roles: " + artist.Roles)))
			@ArchivedEntryHelpers.DataRowList("Tracks", data, compareToData, d => DataFormatUtils.GenerateHtml(d.Songs, song => MvcHtmlString.Create("(Disc " + song.DiscNumber + ") " + song.TrackNumber + ". " + song.NameHint + " [" + song.Id + "]")))
			@ArchivedEntryHelpers.DataRowList("PVs", data, compareToData, d => DataFormatUtils.GenerateHtmlFromHelper(d.PVs, ArchivedEntryHelpers.PVInfo))
		</table>	

	</fieldset>

}