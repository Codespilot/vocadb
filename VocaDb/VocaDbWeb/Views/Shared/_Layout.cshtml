@using VocaDb.Web.Helpers
@using VocaDb.Model.Domain.Security

<!DOCTYPE html>
<html>
<head>
    <title>Vocaloid Database@(!string.IsNullOrEmpty(ViewBag.Title) ? " - " + ViewBag.Title : "")</title>
	<meta name="description" content="Vocaloid database with translated artists, albums and songs." />	
	<meta name="keywords" content="Vocaloid, VocaDB, Vocaloid database, Hatsune Miku" />

	<link rel="shortcut icon" href="@Url.Content("~/Content/favicon.ico")" type="image/x-icon" />
    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/Content/Styles/Icons.css")" rel="stylesheet" type="text/css" />
	<link href="@Url.Content("~/Content/themes/base/jquery-ui.css")" rel="stylesheet" type="text/css" />

    <script src="@Url.Content("~/Scripts/jquery-1.6.4.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/ui/minified/jquery-ui.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/VocaDb.js")" type="text/javascript"></script>
	<script src="/Scripts/MicrosoftAjax.js" type="text/javascript"></script>
	<script src="/Scripts/MicrosoftMvcAjax.js" type="text/javascript"></script>
	<!--<script src="http://cdn.jquerytools.org/1.2.6/jquery.tools.min.js" type="text/javascript"></script>-->

	<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>
	<script type="text/javascript">

		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-26327627-1']);
		_gaq.push(['_setDomainName', 'vocadb.net']);
		_gaq.push(['_trackPageview']);

		(function () {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();

	</script>
</head>

<body>
	<table>
		<tr>
			<td class="menu">
				<h2>VocaDB</h2>
				<ul>
					<li>@Html.ActionLink(ViewRes._LayoutStrings.Home, "Index", "Home")</li>
					<li>
						@Html.ActionLink(ViewRes.SharedStrings.Artists, "Index", "Artist")
						<ul>
							@if (Login.CanManageDb) {
							<li>@Html.ActionLink(ViewRes._LayoutStrings.AddArtist, "Create", "Artist")</li>
							}
							<li>@Html.ActionLink(ViewRes.SharedStrings.Drafts, "Index", "Artist", new { draftsOnly = true }, null)</li>
						</ul>
					</li>
					<li>
						@Html.ActionLink(ViewRes.SharedStrings.Albums, "Index", "Album")
						<ul>
							@if (Login.CanManageDb) {
							<li>@Html.ActionLink(ViewRes._LayoutStrings.AddAlbum, "Create", "Album")</li>
							}
							<li>@Html.ActionLink(ViewRes.SharedStrings.Drafts, "Index", "Album", new { draftsOnly = true }, null)</li>
							<li>@Html.ActionLink(ViewRes._LayoutStrings.TopRatedAlbums, "TopRated", "Album")</li>
						</ul>
					</li>
					<li>
						@Html.ActionLink(ViewRes.SharedStrings.Songs, "Index", "Song")
						<ul>
							@if (Login.CanManageDb) {
							<li>@Html.ActionLink(ViewRes._LayoutStrings.AddSong, "Create", "Song")</li>
							}
							<li>@Html.ActionLink(ViewRes.SharedStrings.Drafts, "Index", "Song", new { draftsOnly = true }, null)</li>
							<li>@Html.ActionLink(ViewRes._LayoutStrings.TopFavoritedSongs, "TopFavorited", "Song")</li>
						</ul>
					</li>
					<li>@Html.ActionLink(ViewRes.SharedStrings.FeaturedSongLists, "Featured", "SongList")</li>
					<li>@Html.ActionLink(ViewRes.SharedStrings.Tags, "Index", "Tag")</li>
					<li>@Html.ActionLink(ViewRes._LayoutStrings.Help, "Index", "Help")</li>
					@if (Login.Manager.HasPermission(PermissionToken.MikuDbImport)) {
					<li>@Html.ActionLink(ViewRes._LayoutStrings.MikuDbAlbum, "Index", "MikuDbAlbum")</li>		 
					}
					@if (Login.CanAccessManageMenu) {
					<li>@Html.ActionLink(ViewRes._LayoutStrings.Manage, "Index", "Admin")</li>
					}
					@if (!Login.Manager.IsLoggedIn) {
					<li>@Html.ActionLink(ViewRes._LayoutStrings.LogIn, "Login", "User")</li>
					<li>@Html.ActionLink(ViewRes._LayoutStrings.Register, "Create", "User")</li>
					} else {
					<li>@Html.ActionLink(ViewRes._LayoutStrings.LogOut, "Logout", "User")</li>
					}
				</ul>
				@if (Login.Manager.IsLoggedIn) {
					<p class="user">@ViewRes._LayoutStrings.Welcome @Html.ActionLink(Login.User.Name, "Profile", "User", new { id = Login.User.Name }, null)</p>
				}
				
				<br />
				@{ Html.RenderPartial("GlobalSearchBox", new VocaDb.Web.Models.GlobalSearchBoxModel()); }
				
				<br /><br />
				<h3>@ViewRes._LayoutStrings.RelatedSites</h3>
				<ul>
					<li><a href="http://mikuchan.org">mikuchan</a></li>
					<li><a href="http://mikudb.com">MikuDB</a></li>
					<li><a href="http://vocaloidotaku.net">VocaloidOtaku</a></li>
					<li><a href="http://vocaloidism.com">Vocaloidism</a></li>
				</ul>

				<br />
				<g:plusone></g:plusone>
			</td>
			<td class="rightFrame">
				@if (ViewBag.Parents != null) {
					foreach (MvcHtmlString link in ViewBag.Parents) {
						<span>
						@link &gt;&gt;
						</span>
					}
				}
				<h2>@ViewBag.Title</h2>

				@if (IsSectionDefined("Toolbar")) {
					<p>
					@RenderSection("Toolbar")
					</p>
				}
				
				@if (Login.Manager.IsLoggedIn && Login.Manager.LoggedUser.HasUnreadMessages) {
					<div class="ui-widget">
						<div class="ui-state-highlight ui-corner-all" style="padding: 0 .7em;">
							<p>
								@Helpers.NotificationIcon()
								<span>@Html.ActionLink("You have unread messages", "Messages", "User")</span>
							</p>
						</div>
					</div>
				}
				
				@if (TempData.StatusMessage() != null) {
					@Helpers.NotificationPanel(TempData.StatusMessage())
				}
		
				@RenderBody()
			</td>
		</tr>
	</table>  

    <script src="@Url.Content("~/Scripts/Shared/NamesList.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/Shared/WebLinksList.js")" type="text/javascript"></script>
	@if (IsSectionDefined("BodyScripts")) {
		@RenderSection("BodyScripts")
	}
</body>
</html>
