@using VocaDb.Web.Models.SongLists;
@using VocaDb.Web.Helpers;
@model SongListEdit
@{
	
	var isNew = (Model.Id == 0);
	
	if (!isNew) {
		ViewBag.Title = "Edit list - " + Model.CurrentName;
		ViewBag.Parents = new[] { 
			LinkExtensions.ActionLink(Html, Model.CurrentName, "Details", new { id = Model.Id }) 
		};
	} else {
		ViewBag.Title = "Create a custom list";		
	}
}

@section Toolbar {
	@if (!isNew) {
		@Html.ActionLink("Delete", "Delete", new { id = Model.Id }, new { id = "deleteLink", onclick = "return confirm(\"Are you sure you want to delete this list?\");" })
	}
}

@section BodyScripts {
<link rel="stylesheet" href="@Url.Content("~/Scripts/jqwidgets/styles/jqx.base.css")" type="text/css" />
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxcore.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxbuttons.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxscrollbar.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/jqwidgets/jqxlistbox.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/Shared/EntrySearchJqx.js")"></script>
<script type="text/javascript" src="@Url.Content("~/Scripts/SongList/Edit.js")"></script>
<script type="text/javascript">

	$(document).ready(function() { 
		initPage(@Model.Id);
	});

</script>
}

@Helpers.ValidationSymmaryPanel("Unable to save properties.")

@using (Html.BeginForm("Edit", "SongList", FormMethod.Post)) {
	@Html.HiddenFor(m => m.Id)
	@Html.HiddenFor(m => m.CurrentName)

	<p>
		<input type="submit" value="Save changes" />
	</p>
	
	<div id="tabs">

		<ul>
			<li><a href="#propertiesTab">Properties</a></li>
			<li><a href="#songsTab">Songs</a></li>
		</ul>

		<div id="propertiesTab">

			<div class="editor-label">
				@Html.LabelFor(m => m.Name)
			</div>
			<div class="editor-field">
				@Html.TextBoxFor(m => m.Name, new { size = 40 })<br />
				@Html.ValidationMessageFor(m => m.Name)
			</div>

			<div class="editor-label">
				@Html.LabelFor(m => m.Description)
			</div>
			<div class="editor-field">
				@Html.TextAreaFor(m => m.Description, new { cols = 60, rows = 4 })
			</div>

		</div>

		<div id="songsTab">

			<table id="songsTable">
				<tbody id="songsTableBody">
				@foreach (var track in Model.SongLinks) {
					Html.RenderPartial("SongInListEditRow", track);
				}
				</tbody>
			</table>

			<br />

			<h4>Add new</h4>
			@Helpers.EntrySearchBox("songAdd", false)
			<br />
			<a href="#" class="textLink addLink" id="songAddAcceptBtn">Add</a>

		</div>

	</div>
	
	<p>
		<input type="submit" value="Save changes" />
	</p>
	
}