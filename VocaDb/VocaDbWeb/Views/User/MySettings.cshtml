@using VocaDb.Web.Models
@using VocaDb.Web.Helpers
@model MySettingsModel

@{
    ViewBag.Title = "My settings";
}

@Html.ValidationSummary(true, "Unable to save settings. Please correct the errors and try again.")

<div id="tabs">

	<ul>
		<li><a href="#accountSettings">Account settings</a></li>
		<li><a href="#myCollection">My collection</a></li>
		<li><a href="#connectivity">Connectivity</a></li>
	</ul>

	<div id="accountSettings">
		@using (Html.BeginForm("MySettings", "User", FormMethod.Post)) {
			@Html.HiddenFor(m => m.Id)
			<div>
				<fieldset>
					<div class="editor-label">
						@Html.LabelFor(m => m.Username)
					</div>
					<div class="editor-field">
						@Html.DisplayFor(m => m.Username)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.Email)
						(optional, used by gravatar and password resets)
					</div>
					<div class="editor-field">
						@Html.TextBoxFor(m => m.Email)
						@Html.ValidationMessageFor(m => m.Email)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.EmailOptions)
					</div>
					<div class="editor-field">
						@Html.EmailOptionsDropDownListFor(m => m.EmailOptions)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.DefaultLanguageSelection)
					</div>
					<div class="editor-field">
						@Html.LanguagePreferenceDropDownListFor(m => m.DefaultLanguageSelection)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.PreferredVideoService)
					</div>
					<div class="editor-field">
						@Html.DropDownListFor(m => m.PreferredVideoService, new SelectList(Model.AllVideoServices, Model.PreferredVideoService))
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.OldPass)
						(required for changing password.)
					</div>
					<div class="editor-field">
						@Html.PasswordFor(m => m.OldPass)
						@Html.ValidationMessageFor(m => m.OldPass)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.NewPass)
						(fill if changing password.)
					</div>
					<div class="editor-field">
						@Html.PasswordFor(m => m.NewPass)
						@Html.ValidationMessageFor(m => m.NewPass)
					</div>

					<div class="editor-label">
						@Html.LabelFor(m => m.NewPassAgain)
					</div>
					<div class="editor-field">
						@Html.PasswordFor(m => m.NewPassAgain)
 						@Html.ValidationMessageFor(m => m.NewPassAgain)
				   </div>

					<p>
						<input type="submit" value="Save" />
					</p>
				</fieldset>
			</div>
		}
	</div>

	<div id="myCollection">

		<table>
		@foreach (var album in Model.AlbumLinks) {
			Html.RenderPartial("AlbumForUserSettingsRow", album);
		}
			
		@{ Html.RenderPartial("AddNewLinkRow", new AddNewLinkRowModel { EntityName = "album", Prefix = "album" }); }
		</table>
		
	</div>

	<div id="connectivity">
	
		<h4>Access key</h4>
		<p>@Model.AccessKey</p>

	</div>
</div>

<script type="text/javascript" src="@Url.Content("~/Scripts/User/MySettings.js")"></script>
<script type="text/javascript">

	$(document).ready(function() { 
		initPage(@Model.Id);
	});

</script>