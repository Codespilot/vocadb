/*
jQWidgets v2.7.0 (2013-Feb-08)
Copyright (c) 2011-2013 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(a){a.extend(a.jqx._jqxGrid.prototype,{_updatefilterrowui:function(f){var m=this.columns.records.length;var e=0;for(var h=0;h<m;h++){var g=this.columns.records[h];var c=g.width;if(c<g.minwidth){c=g.minwidth}if(c>g.maxwidth){c=g.maxwidth}var l=a(this.filterrow[0].cells[h]);l.css("left",e);var k=true;if(l.width()==c){k=false}if(f){k=true}l.width(c);l[0].left=e;if(!(g.hidden&&g.hideable)){e+=c}else{l.css("display","none")}if(!k){continue}if(g.createfilterwidget&&g.filtertype=="custom"){g.createfilterwidget(g,l)}else{if(g.filterable){var d=function(n,o){var j=a(o.children()[0]);j.width(c-10)};switch(g.filtertype){case"number":a(l.children()[0]).width(c);l.find("input").width(c-30);break;case"date":if(this.host.jqxDateTimeInput){a(l.children()[0]).jqxDateTimeInput({width:c-10})}else{d(this,l)}break;case"textbox":case"default":d(this,l);break;case"list":case"checkedlist":if(this.host.jqxDropDownList){a(l.children()[0]).jqxDropDownList({width:c-10})}else{d(this,l)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){d(this,l)}break}}}}var b=a(this.filterrow.children()[0]);b.width(parseInt(e)+2);b.height(this.filterrowheight)},clearfilterrow:function(){this._disablefilterrow=true;var b=this.columns.records.length;var f=0;for(var d=0;d<b;d++){var c=this.columns.records[d];var g=a(this.filterrow[0].cells[d]);if(c.filterable){var e=function(j,k){var h=a(k.children()[0]);h.val("");j["_oldWriteText"+h[0].id]=""};switch(c.filtertype){case"number":g.find("input").val("");break;case"date":if(this.host.jqxDateTimeInput){a(g.children()[0]).jqxDateTimeInput("setDate",null)}else{e(this,g)}break;case"textbox":case"default":e(this,g);break;case"list":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("clearSelection")}else{e(this,g)}break;case"checkedlist":if(this.host.jqxDropDownList){a(g.children()[0]).jqxDropDownList("checkAll",false)}else{e(this,g)}break;case"bool":case"boolean":if(!this.host.jqxCheckBox){e(this,g)}else{a(g.children()[0]).jqxCheckBox({checked:null})}break}}}this._disablefilterrow=false},_applyfilterfromfilterrow:function(){if(this._disablefilterrow==true){return}var z=this.columns.records.length;var C=this;for(var t=0;t<z;t++){var k=new a.jqx.filter();var u=this.columns.records[t];if(!u.filterable){continue}var f=C._getcolumntypebydatafield(u);var d=C._getfiltertype(f);var l=1;var D=true;var e=u.filtertype;var A=function(F,L,I){var j=true;if(F._filterwidget){var G=F._filterwidget.val();if(G!=""){var J="equal";if(L=="stringfilter"){var J="contains"}if(L!="stringfilter"){var K=0;if(G.indexOf(">")!=-1){J="greater_than";K=1}if(G.indexOf("<")!=-1){J="less_than";K=1}if(G.indexOf("=")!=-1){if(J=="greater_than"){J="greater_than_or_equal";K=2}else{if(J=="less_than"){J="less_than_or_equal";K=2}else{J="equal";K=1}}}if(K!=0){G=G.substring(K);if(G.length<1){return false}}}if(F.filtercondition!=undefined){J=F.filtercondition}var H=I.createfilter(L,G,J);I.addfilter(l,H)}else{j=false}}return j};switch(u.filtertype){case"date":if(u._filterwidget.jqxDateTimeInput){var p=u._filterwidget.jqxDateTimeInput("getRange");if(p!=null&&p.from!=null&&p.to!=null){var o="GREATER_THAN_OR_EQUAL";var r=new Date(0);r.setHours(0);r.setFullYear(p.from.getFullYear(),p.from.getMonth(),p.from.getDate());var q=new Date(0);q.setHours(0);q.setFullYear(p.to.getFullYear(),p.to.getMonth(),p.to.getDate());q.setHours(p.to.getHours());q.setMinutes(p.to.getMinutes());q.setSeconds(p.to.getSeconds());var y=k.createfilter(d,r,o);k.addfilter(0,y);var c="LESS_THAN_OR_EQUAL";var x=k.createfilter(d,q,c);k.addfilter(0,x)}else{D=false}}else{D=A(u,d,k)}break;case"number":if(u._filterwidget){var p=u._filterwidget.find("input").val();var h=u._filterwidget.find(".filter").jqxDropDownList("selectedIndex");var w=k.getoperatorsbyfiltertype(d)[h];if(C.updatefilterconditions){var E=C.updatefilterconditions(d,k.getoperatorsbyfiltertype(d));if(E!=undefined){k.setoperatorsbyfiltertype(d,E)}var w=k.getoperatorsbyfiltertype(d)[h]}var n=w=="NULL"||w=="NOT_NULL";var s=w=="EMPTY"||w=="NOT_EMPTY";if(p!=undefined&&p.length>0||n||s){y=k.createfilter(d,p,w,null,u.cellsformat,C.gridlocalization);k.addfilter(0,y)}else{D=false}}else{D=false}break;case"textbox":case"default":D=A(u,d,k);break;case"bool":case"boolean":if(u._filterwidget.jqxCheckBox){var p=u._filterwidget.jqxCheckBox("checked");if(p!=null){var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}}else{D=A(u,d,k)}break;case"list":var g=u._filterwidget.jqxDropDownList("listBox");if(g.selectedIndex>0){var b=g.getItem(g.selectedIndex);var p=b.value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}else{D=false}break;case"checkedlist":if(u._filterwidget.jqxDropDownList){var g=u._filterwidget.jqxDropDownList("listBox");var B=g.getCheckedItems();if(B.length==0){for(var v=1;v<g.items.length;v++){var p=g.items[v].value;var o="not_equal";var m=k.createfilter(d,p,o);k.addfilter(0,m)}D=true}else{if(B.length!=g.items.length){for(var v=0;v<B.length;v++){var p=B[v].value;var o="equal";var m=k.createfilter(d,p,o);k.addfilter(l,m)}}else{D=false}}}else{D=A(u,d,k)}break}if(!this._loading){if(D){this.addfilter(u.displayfield,k,false)}else{this.removefilter(u.displayfield,false)}}}if(!this._loading){this.applyfilters()}},_updatefilterrow:function(){var b=a('<div style="position: relative;" id="row00'+this.element.id+'"></div>');var f=0;var p=this.columns.records.length;var n=this.toThemeProperty("jqx-grid-cell");n+=" "+this.toThemeProperty("jqx-grid-cell-pinned");var r=p+10;var s=new Array();var o=this;this.filterrow[0].cells=s;b.height(this.filterrowheight);this.filterrow.children().detach();this.filterrow.append(b);if(!this._filterrowcache){this._filterrowcache=new Array()}var g=false;var d=new Array();for(var h=0;h<p;h++){var e=this.columns.records[h];var c=e.width;if(c<e.minwidth){c=e.minwidth}if(c>e.maxwidth){c=e.maxwidth}var m=a('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+n+'"></div>');b.append(m);m.css("left",f);if(this.rtl){m.css("z-index",r++);m.css("border-left-width","1px")}else{m.css("z-index",r--)}m.width(c);m[0].left=f;if(!(e.hidden&&e.hideable)){f+=c}else{m.css("display","none")}s[s.length]=m[0];var l=true;if(this.groupable){var q=this.rowdetails?1:0;if(this.groups.length+q>h){l=false}}if(this.rowdetails&&h==0){l=false}if(l){if(e.filtertype=="custom"&&e.createfilterwidget){var k=function(){o._applyfilterfromfilterrow()};e.createfilterwidget(e,m,k)}else{if(e.filterable){if(this._filterrowcache[e.datafield]){g=true;m.append(this._filterrowcache[e.datafield]);e._filterwidget=this._filterrowcache[e.datafield]}else{this._addfilterwidget(e,m,c);d[e.datafield]=e._filterwidget}}}}}this._filterrowcache=d;if(a.jqx.browser.msie&&a.jqx.browser.version<8){b.css("z-index",r--)}b.width(parseInt(f)+2);this.filterrow.addClass(n);this.filterrow.css("border-top-width","1px");if(g){this._updatefilterrowui(true)}},_addfilterwidget:function(z,d,x){var C=this;var w="";for(var A=0;A<C.dataview.filters.length;A++){var u=C.dataview.filters[A];if(u.datafield&&u.datafield==z.datafield){w=u.filter.getfilters()[0].value;break}}var g=function(D,E){var f=a('<input autocomplete="off" type="textarea"/>');f[0].id=a.jqx.utilities.createId();f.addClass(D.toThemeProperty("jqx-input"));f.addClass(D.toThemeProperty("jqx-widget-content"));if(D.rtl){f.css("direction","rtl")}f.appendTo(E);f.width(x-10);f.height(D.filterrowheight-10);f.css("margin","4px");if(z.createfilterwidget){z.createfilterwidget(z,E,f)}z._filterwidget=f;f.focus(function(){D.focusedfilter=f});f.on("keydown",function(F){if(F.keyCode=="13"){D._applyfilterfromfilterrow()}if(f[0]._writeTimer){clearTimeout(f[0]._writeTimer)}f[0]._writeTimer=setTimeout(function(){if(!D._loading){if(D["_oldWriteText"+f[0].id]!=f.val()){D._applyfilterfromfilterrow();D["_oldWriteText"+f[0].id]=f.val()}}},400);D.focusedfilter=f});D.host.removeClass("jqx-disableselect");D.content.removeClass("jqx-disableselect");f.val(w)};switch(z.filtertype){case"number":var l=a("<div></div>");l.width(d.width());l.height(this.filterrowheight);d.append(l);var x=d.width()-20;var p=function(E,F,f){var D=a('<input style="float: left;" autocomplete="off" type="textarea"/>');if(C.rtl){D.css("float","right");D.css("direction","rtl")}D[0].id=a.jqx.utilities.createId();D.addClass(C.toThemeProperty("jqx-input"));D.addClass(C.toThemeProperty("jqx-widget-content"));D.appendTo(E);D.width(F-10);D.height(C.filterrowheight-10);D.css("margin","4px");D.css("margin-right","2px");D.on("keydown",function(G){if(G.keyCode=="13"){C._applyfilterfromfilterrow()}if(D[0]._writeTimer){clearTimeout(D[0]._writeTimer)}D[0]._writeTimer=setTimeout(function(){if(!C._loading){if(C["_oldWriteText"+D[0].id]!=D.val()){C._applyfilterfromfilterrow();C["_oldWriteText"+D[0].id]=D.val()}}},400);C.focusedfilter=D});D.val(w);return D};p(l,x);var y=C._getfiltersbytype("number");var q=a("<div class='filter' style='float: left;'></div>");q.css("margin-top","4px");q.appendTo(l);if(C.rtl){q.css("float","right")}var h=2;if(z.filtercondition!=null){var e=y.indexOf(z.filtercondition);if(e!=-1){h=e}}q.jqxDropDownList({rtl:C.rtl,dropDownHorizontalAlignment:"right",enableBrowserBoundsDetection:true,selectedIndex:h,width:18,height:20,dropDownHeight:150,dropDownWidth:170,source:y,theme:C.theme});q.jqxDropDownList({selectionRenderer:function(f){return""}});q.jqxDropDownList("setContent","");q.find(".jqx-dropdownlist-content").hide();if(z.createfilterwidget){z.createfilterwidget(z,d,l)}z._filterwidget=l;q.on("select",function(){if(z._filterwidget.find("input").val().length>0){C._applyfilterfromfilterrow()}});break;case"textbox":case"default":default:g(this,d);break;case"date":if(this.host.jqxDateTimeInput){var b=a("<div></div>");b.css("margin","4px");b.appendTo(d);b.jqxDateTimeInput({rtl:C.rtl,showFooter:true,formatString:z.cellsformat,selectionMode:"range",value:null,theme:this.theme,width:x-10,height:this.filterrowheight-10});if(z.createfilterwidget){z.createfilterwidget(z,d,b)}z._filterwidget=b;b.on("valuechanged",function(f){C._applyfilterfromfilterrow();C.focusedfilter=null})}else{g(this,d)}break;case"list":case"checkedlist":if(this.host.jqxDropDownList){var o=this._getfilterdataadapter(z);var k=true;var q=a("<div></div>");q.css("margin","4px");var r=z.datafield;var s=z.filtertype=="checkedlist"?true:false;q.jqxDropDownList({rtl:C.rtl,checkboxes:s,source:o,autoDropDownHeight:k,theme:this.theme,width:x-10,height:this.filterrowheight-10,displayMember:z.displayfield,valueMember:r});q.appendTo(d);var n=q.jqxDropDownList("getItems");var c=q.jqxDropDownList("listBox");if(n.length<8){q.jqxDropDownList("autoDropDownHeight",true)}else{q.jqxDropDownList("autoDropDownHeight",false);k=false}if(s){q.jqxDropDownList({selectionRenderer:function(){return C.gridlocalization.filterselectstring}});var v=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+C.gridlocalization.filterselectstring+"</span>");v.addClass(this.toThemeProperty("jqx-item"));if(c!=undefined){if(!k){c.host.height(200)}c.insertAt(C.gridlocalization.filterselectallstring,0);q.jqxDropDownList("setContent",v);var j=true;var B=new Array();c.checkAll(false);c.host.on("checkChange",function(E){q[0]._selectionChanged=true;if(!j){return}if(E.args.label!=C.gridlocalization.filterselectallstring){j=false;c.host.jqxListBox("checkIndex",0,true,false);var f=c.host.jqxListBox("getCheckedItems");var D=c.host.jqxListBox("getItems");if(f.length==1){c.host.jqxListBox("uncheckIndex",0,true,false)}else{if(D.length!=f.length){c.host.jqxListBox("indeterminateIndex",0,true,false)}}j=true}else{j=false;if(E.args.checked){c.host.jqxListBox("checkAll",false)}else{c.host.jqxListBox("uncheckAll",false)}j=true}})}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);q.jqxDropDownList({selectedIndex:0})}if(z.createfilterwidget){z.createfilterwidget(z,d,q)}z._filterwidget=q;var m=q.jqxDropDownList("dropdownlistWrapper");if(z.filtertype=="list"){this.addHandler(q,"select",function(f){if(f.args&&f.args.type!="none"){C._applyfilterfromfilterrow();C.focusedfilter=null}})}else{this.addHandler(q,"close",function(f){if(q[0]._selectionChanged){C._applyfilterfromfilterrow();C.focusedfilter=null;q[0]._selectionChanged=false}})}}else{g(this,d)}break;case"bool":case"boolean":if(this.host.jqxCheckBox){var t=a('<div tabIndex=0 style="opacity: 0.99; position: absolute; top: 50%; left: 50%; margin-top: -7px; margin-left: -10px;"></div>');t.appendTo(d);t.jqxCheckBox({enableContainerClick:false,animationShowDelay:0,animationHideDelay:0,hasThreeStates:true,theme:this.theme,checked:null});if(z.createfilterwidget){z.createfilterwidget(z,d,t)}if(w===true||w=="true"){t.jqxCheckBox({checked:true})}else{if(w===false||w=="false"){t.jqxCheckBox({checked:false})}}z._filterwidget=t;t.on("change",function(f){if(f.args){C.focusedfilter=null;C._applyfilterfromfilterrow()}})}else{g(this,d)}break}},_getfilterdataadapter:function(b){var c=this.source._source?true:false;if(!c){dataadapter=new a.jqx.dataAdapter(this.source,{autoBind:false,uniqueDataFields:[b.displayfield],async:false})}else{var d={localdata:this.source.records,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,async:false,uniqueDataFields:[b.displayfield]})}if(b.filteritems&&b.filteritems.length>0){var d={localdata:b.filteritems,datatype:this.source.datatype,async:false};dataadapter=new a.jqx.dataAdapter(d,{autoBind:false,async:false})}return dataadapter},refreshfilterrow:function(){this._updatefilterrowui();this._updatelistfilters();var l=this;var o=this.columns.records.length;for(var e=0;e<o;e++){var d=this.columns.records[e];if(d.filterable){if(d.filter){var c=d.filter.getfilters();if(c.length>0){var n=c[0].value;var f=d._filterwidget;var g=d._filterwidget.parent();if(f!=null){switch(d.filtertype){case"number":g.find("input").val(n);if(this.host.jqxDropDownList){var m=d.filter.getoperatorsbyfiltertype("numericfilter");f.find(".filter").jqxDropDownList("selectIndex",m.indexOf(c[0].condition))}break;case"date":if(this.host.jqxDateTimeInput){var k=data.filters["filtervalue"+(i+1)];var h=data.filters["filtertype"+i];var b=filtergroup.createfilter(h,k,"LESS_THAN_OR_EQUAL");filtergroup.addfilter(operator,b);a(g.children()[0]).jqxDateTimeInput("setRange",new Date(n),new Date(k));i++}else{f.val(n)}break;case"textbox":case"default":f.val(n);l["_oldWriteText"+f[0].id]=n;break;case"bool":case"boolean":if(!this.host.jqxCheckBox){f.val(n)}else{a(g.children()[0]).jqxCheckBox({checked:n})}break}}}}}}},_destroyedfilters:function(){var g=this;var b=this.columns.records.length;for(var f=0;f<b;f++){var c=this.columns.records[f];if(c.filterable){var h=c._filterwidget;if(c.filtertype=="list"||c.filtertype=="checkedlist"){this.removeHandler(h,"select");this.removeHandler(h,"close");h.jqxDropDownList("destroy")}else{if(c.filtertype=="date"){this.removeHandler(h,"valuechanged");h.jqxDateTimeInput("destroy")}else{if(c.filtertype=="bool"){this.removeHandler(h,"change");h.jqxCheckBox("destroy")}else{if(c.filtertype=="number"){var d=h.find(".jqx-input");this.removeHandler(d,"keydown");var e=a(h.children()[1]);e.jqxDropDownList("destroy")}else{this.removeHandler(h,"keydown")}}}}h.remove()}}},_updatelistfilters:function(n){var o=this;var r=this.columns.records.length;for(var h=0;h<r;h++){var f=this.columns.records[h];if(f.filterable){if(f.filtertype=="list"||f.filtertype=="checkedlist"){var m=f._filterwidget;if(!n){if(f.filter==undefined){m.jqxDropDownList("renderSelection");continue}}else{var b=this._getfilterdataadapter(f);b.dataBind();var g=m.jqxDropDownList("getItems");var s=true;if(g.length!=b.records.length+1){s=false}if(s){for(var k=1;k<g.length;k++){if(g[k].label!=b.records[k-1][f.displayfield]){s=false;break}}}if(s){continue}}m.jqxDropDownList("dataBind");var l=f.filtertype=="checkedlist"?true:false;var g=m.jqxDropDownList("getItems");var c=m.jqxDropDownList("listBox");if(l){m.jqxDropDownList({selectionRenderer:function(){return o.gridlocalization.filterselectstring}});var e=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+this.gridlocalization.filterselectstring+"</span>");e.addClass(this.toThemeProperty("jqx-item"));c.insertAt(this.gridlocalization.filterselectallstring,0);m.jqxDropDownList("setContent",e);c.checkAll(false);if(f.filter){c.uncheckAll(false);var d=f.filter.getfilters();for(var k=0;k<c.items.length;k++){var q=c.items[k].label;a.each(d,function(){if(this.condition=="NOT_EQUAL"){return true}if(q==this.value){c.checkIndex(k,false,false)}})}c._updateCheckedItems();var p=c.getCheckedItems().length;if(c.items.length!=p&&p>0){c.host.jqxListBox("indeterminateIndex",0,true,false)}}}else{c.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0);m.jqxDropDownList({selectedIndex:0})}if(g.length<8){m.jqxDropDownList("autoDropDownHeight",true)}else{m.jqxDropDownList("autoDropDownHeight",false)}}}}},_renderfiltercolumn:function(){var b=this;if(this.filterable){a.each(this.columns.records,function(c,d){if(b.autoshowfiltericon){if(this.filter){a(this.filtericon).show()}else{a(this.filtericon).hide()}}else{if(this.filterable){a(this.filtericon).show()}}})}},_getcolumntypebydatafield:function(e){var f=this;var d="string";var c=f.source.datafields||((f.source._source)?f.source._source.datafields:null);if(c){var h="";a.each(c,function(){if(this.name==e.displayfield){if(this.type){h=this.type}return false}});if(h){return h}}if(e!=null){if(this.dataview.cachedrecords==undefined){return d}var b=null;if(!this.virtualmode){if(this.dataview.cachedrecords.length==0){return d}b=this.dataview.cachedrecords[0][e.displayfield];if(b!=null&&b.toString()==""){return"string"}}else{a.each(this.dataview.cachedrecords,function(){b=this[e.displayfield];return false})}if(b!=null){if(typeof b=="boolean"){d="boolean"}else{if(a.jqx.dataFormat.isNumber(b)){d="number"}else{var g=new Date(b);if(g.toString()=="NaN"||g.toString()=="Invalid Date"){if(a.jqx.dataFormat){g=a.jqx.dataFormat.tryparsedate(b);if(g!=null){return"date"}else{d="string"}}else{d="string"}}else{d="date"}}}}}return d},_getfiltersbytype:function(b){var c=this;var d="";switch(b){case"number":case"float":case"int":d=c.gridlocalization.filternumericcomparisonoperators;break;case"date":d=c.gridlocalization.filterdatecomparisonoperators;break;case"boolean":case"bool":d=c.gridlocalization.filterbooleancomparisonoperators;break;case"string":default:d=c.gridlocalization.filterstringcomparisonoperators;break}return d},_updatefilterpanel:function(A,c,d){if(A==null||A==undefined){A=this}var e=A._getcolumntypebydatafield(d);var v=A._getfiltersbytype(e);if(!A.host.jqxDropDownList){alert("jqxdropdownlist is not loaded.");return}var t=a(c);var p=t.find("#filterclearbutton"+A.element.id);var j=t.find("#filterbutton"+A.element.id);var x=t.find("#filter1"+A.element.id);var u=t.find("#filter2"+A.element.id);var w=t.find("#filter3"+A.element.id);var s=t.find(".filtertext1"+A.element.id);var r=t.find(".filtertext2"+A.element.id);s.val("");r.val("");this.removeHandler(j,"click");this.addHandler(j,"click",function(){A._buildfilter(A,c,d);A._closemenu()});this.removeHandler(p,"click");this.addHandler(p,"click",function(){A._clearfilter(A,c,d);A._closemenu()});if(x.jqxDropDownList("source")!=v){x.jqxDropDownList({enableBrowserBoundsDetection:false,source:v});w.jqxDropDownList({enableBrowserBoundsDetection:false,source:v})}if(e=="boolean"||e=="bool"){x.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0});w.jqxDropDownList({autoDropDownHeight:true,selectedIndex:0})}else{var f=false;if(v&&v.length){if(v.length<5){f=true}}x.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2});w.jqxDropDownList({autoDropDownHeight:f,selectedIndex:2})}u.jqxDropDownList({selectedIndex:0});var n=d.filter;if(n!=null){var z=n.getfilterat(0);var y=n.getfilterat(1);var m=n.getoperatorat(0);var k=[];var b="";switch(e){case"number":case"int":case"float":case"decimal":b="numericfilter";k=n.getoperatorsbyfiltertype("numericfilter");break;case"boolean":case"bool":b="booleanfilter";k=n.getoperatorsbyfiltertype("booleanfilter");break;case"date":case"time":b="datefilter";k=n.getoperatorsbyfiltertype("datefilter");break;case"string":b="stringfilter";k=n.getoperatorsbyfiltertype("stringfilter");break}if(A.updatefilterconditions){var B=A.updatefilterconditions(b,k);if(B!=undefined){n.setoperatorsbyfiltertype(b,B);k=B}}var l=this.enableanimations?"default":"none";if(z!=null){var h=k.indexOf(z.comparisonoperator);var q=z.filtervalue;s.val(q);x.jqxDropDownList({selectedIndex:h,animationType:l})}if(y!=null){var g=k.indexOf(y.comparisonoperator);var o=y.filtervalue;r.val(o);w.jqxDropDownList({selectedIndex:g,animationType:l})}if(n.getoperatorat(0)==undefined){u.jqxDropDownList({selectedIndex:0,animationType:l})}else{if(n.getoperatorat(0)=="and"||n.getoperatorat(0)==0){u.jqxDropDownList({selectedIndex:0})}else{u.jqxDropDownList({selectedIndex:1})}}}if(A.updatefilterpanel){A.updatefilterpanel(x,w,u,s,r,j,p,n,b,k)}s.focus();setTimeout(function(){s.focus()},10)},_getfiltertype:function(b){var c="stringfilter";switch(b){case"number":case"int":case"float":case"decimal":c="numericfilter";break;case"boolean":case"bool":c="booleanfilter";break;case"date":case"time":c="datefilter";break;case"string":c="stringfilter";break}return c},_buildfilter:function(B,d,e){var y=a(d).find("#filter1"+B.element.id);var k=a(d).find("#filter2"+B.element.id);var v=a(d).find("#filter3"+B.element.id);var r=a(d).find(".filtertext1"+B.element.id);var q=a(d).find(".filtertext2"+B.element.id);var p=r.val();var n=q.val();var f=B._getcolumntypebydatafield(e);var s=B._getfiltersbytype(f);var h=y.jqxDropDownList("selectedIndex");var x=k.jqxDropDownList("selectedIndex");var g=v.jqxDropDownList("selectedIndex");var j=new a.jqx.filter();var A=null;var z=null;var c=B._getfiltertype(f);if(B.updatefilterconditions){var C=B.updatefilterconditions(c,j.getoperatorsbyfiltertype(c));if(C!=undefined){j.setoperatorsbyfiltertype(c,C)}}var b=false;var w=j.getoperatorsbyfiltertype(c)[h];var v=j.getoperatorsbyfiltertype(c)[g];var o=w=="NULL"||w=="NOT_NULL";var u=w=="EMPTY"||w=="NOT_EMPTY";if(w==undefined){w=j.getoperatorsbyfiltertype(c)[0]}if(v==undefined){v=j.getoperatorsbyfiltertype(c)[0]}if(p.length>0||o||u){A=j.createfilter(c,p,w,null,e.cellsformat,B.gridlocalization);j.addfilter(x,A);b=true}var m=v=="NULL"||v=="NOT_NULL";var t=v=="EMPTY"||v=="NOT_EMPTY";if(n.length>0||m||t){z=j.createfilter(c,n,v,null,e.cellsformat,B.gridlocalization);j.addfilter(x,z);b=true}if(b){var l=e.displayfield;this.addfilter(l,j,true)}else{this._clearfilter(B,d,e)}},_clearfilter:function(e,c,d){var b=d.displayfield;this.removefilter(b,true)},addfilter:function(d,e,c){if(this._loading){alert(this.loadingerrormessage);return false}var f=this.getcolumn(d);var b=this._getcolumn(d);if(f==undefined||f==null){return}f.filter=e;b.filter=e;this.dataview.addfilter(d,e);if(c==true&&c!=undefined){this.applyfilters()}},removefilter:function(d,c){if(this._loading){alert(this.loadingerrormessage);return false}var e=this.getcolumn(d);var b=this._getcolumn(d);if(e==undefined||e==null){return}if(e.filter==null){return}this.dataview.removefilter(d,e.filter);e.filter=null;b.filter=null;if(c==true||c!=undefined){this.applyfilters()}},applyfilters:function(){var c=false;if(this.dataview.filters.length>=0&&(this.virtualmode||!this.source.localdata)){if(this.source!=null&&this.source.filter){var f=-1;if(this.pageable){f=this.dataview.pagenum;this.dataview.pagenum=0}this.source.filter(this.dataview.filters,this.dataview.records,this.dataview.records.length);if(this.pageable){this.dataview.pagenum=f}}}if(!this.virtualmode){var b=this.selectedrowindexes;var d=this;if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length==0){var e=new Array();a.each(b,function(){var g=d.getrowdata(this);if(g&&g.dataindex){e[e.length]=g.dataindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}this.dataview.refresh();if(b.length>0){if(this.dataview.filters&&this.dataview.filters.length>0){var e=new Array();a.each(b,function(){var g=d.dataview._dataIndexToBoundIndex[this];if(g!=null){e[e.length]=g.boundindex}});this.selectedrowindexes=e;this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[0]:-1}}}else{if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0)}}this.rendergridcontent(false,false);this._raiseEvent(13,{filters:this.dataview.filters});return}if(this.pageable){this.dataview.updateview();if(this.gotopage){this.gotopage(0);this.updatepagerdetails()}}this._updaterowsproperties();if(!this.groupable||(this.groupable&&this.groups.length==0)){this._rowdetailscache=new Array();this.virtualsizeinfo=null;this._pagescache=new Array();this.rendergridcontent(true,true);this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo);if(this.showaggregates&&this._updatecolumnsaggregates){this._updatecolumnsaggregates()}}else{this._rowdetailscache=new Array();this._render(true,true,false,false,false);if(this.showfilterrow){this._updatefocusedfilter()}this._updatecolumnwidths();this._updatecellwidths();this._renderrows(this.virtualsizeinfo)}this._raiseEvent(13,{filters:this.dataview.filters})},getfilterinformation:function(){var d=new Array();for(var b=0;b<this.dataview.filters.length;b++){var c=this.getcolumn(this.dataview.filters[b].datafield);d[b]={filter:this.dataview.filters[b].filter,filtercolumn:c.datafield,filtercolumntext:c.text}}return d},clearfilters:function(b){var c=this;if(this.showfilterrow){this.clearfilterrow()}if(this.columns.records){a.each(this.columns.records,function(){c.removefilter(this.displayfield)})}if(b==true||b!=undefined){this.applyfilters()}},_destroyfilterpanel:function(){var e=a(a.find("#filterclearbutton"+this.element.id));var d=a(a.find("#filterbutton"+this.element.id));var h=a(a.find("#filter1"+this.element.id));var c=a(a.find("#filter2"+this.element.id));var g=a(a.find("#filter3"+this.element.id));var f=a(a.find(".filtertext1"+this.element.id));var b=a(a.find(".filtertext2"+this.element.id));if(f.length>0&&b.length>0){f.removeClass();b.removeClass();f.remove();b.remove()}if(e.length>0){e.jqxButton("destroy");d.jqxButton("destroy");this.removeHandler(e,"click");this.removeHandler(d,"click")}if(h.length>0){h.jqxDropDownList("destroy")}if(c.length>0){c.jqxDropDownList("destroy")}if(g>0){g.jqxDropDownList("destroy")}},_initfilterpanel:function(v,b,c,n){if(v==null||v==undefined){v=this}b[0].innerHTML="";var r=a("<div class='filter' style='margin-left: 7px;'></div>");b.append(r);var m=a("<div class='filter' style='margin-top: 3px; margin-bottom: 3px;'></div>");m.text(v.gridlocalization.filtershowrowstring);var s=a("<div class='filter' id='filter1"+v.element.id+"'></div>");var g=a("<div class='filter' id='filter2"+v.element.id+"' style='margin-bottom: 3px;'></div>");var q=a("<div class='filter' id='filter3"+v.element.id+"'></div>");var d=v._getcolumntypebydatafield(c);if(!s.jqxDropDownList){alert("jqxdropdownlist is not loaded.");return}var o=v._getfiltersbytype(d);var j=a("<div class='filter'><input class='filtertext1"+v.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input></div>");var l=j.find("input");l.addClass(this.toThemeProperty("jqx-input"));l.addClass(this.toThemeProperty("jqx-widget-content"));l.addClass(this.toThemeProperty("jqx-rc-all"));l.width(n-15);var k=a("<div class='filter'><input class='filtertext2"+v.element.id+"' style='height: 20px; margin-top: 3px;' type='text'></input></div>");var h=k.find("input");h.addClass(this.toThemeProperty("jqx-input"));h.addClass(this.toThemeProperty("jqx-widget-content"));h.addClass(this.toThemeProperty("jqx-rc-all"));h.width(n-15);if(v.rtl){l.css("direction","rtl");h.css("direction","rtl")}var f=a("<div class='filter' style='height: 25px; margin-left: 20px; margin-top: 7px;'></div>");var e=a('<span tabIndex=0 id="filterbutton'+v.element.id+'" class="filterbutton" style="padding: 4px 12px; margin-left: 2px;">'+v.gridlocalization.filterstring+"</span>");f.append(e);var t=a('<span tabIndex=0 id="filterclearbutton'+v.element.id+'" class="filterclearbutton" style="padding: 4px 12px; margin-left: 5px;">'+v.gridlocalization.filterclearstring+"</span>");f.append(t);e.jqxButton({height:20,theme:v.theme});t.jqxButton({height:20,theme:v.theme});var u=function(x){if(x){if(x.text().indexOf("case sensitive")!=-1){var w=x.text();w=w.replace("case sensitive","match case");x.text(w)}x.css("font-family",v.host.css("font-family"));x.css("font-size",v.host.css("font-size"));return x}return""};r.append(m);r.append(s);s.jqxDropDownList({rtl:v.rtl,enableBrowserBoundsDetection:false,selectedIndex:2,width:n-15,height:20,dropDownHeight:150,dropDownWidth:n-15,selectionRenderer:u,source:o,theme:v.theme});r.append(j);var p=new Array();p[0]=v.gridlocalization.filterandconditionstring;p[1]=v.gridlocalization.filterorconditionstring;g.jqxDropDownList({rtl:v.rtl,enableBrowserBoundsDetection:false,autoDropDownHeight:true,selectedIndex:0,width:60,height:20,source:p,selectionRenderer:u,theme:v.theme});r.append(g);q.jqxDropDownList({rtl:v.rtl,enableBrowserBoundsDetection:false,selectedIndex:2,width:n-15,height:20,dropDownHeight:150,dropDownWidth:n-15,selectionRenderer:u,source:o,theme:v.theme});r.append(q);r.append(k);r.append(f);if(v.updatefilterpanel){v.updatefilterpanel(s,q,g,j,k,e,t,null,null,o)}}});a.jqx.filter=function(){this.operator="and";var h=0;var e=1;var l=["EMPTY","NOT_EMPTY","CONTAINS","CONTAINS_CASE_SENSITIVE","DOES_NOT_CONTAIN","DOES_NOT_CONTAIN_CASE_SENSITIVE","STARTS_WITH","STARTS_WITH_CASE_SENSITIVE","ENDS_WITH","ENDS_WITH_CASE_SENSITIVE","EQUAL","EQUAL_CASE_SENSITIVE","NULL","NOT_NULL"];var n=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var o=["EQUAL","NOT_EQUAL","LESS_THAN","LESS_THAN_OR_EQUAL","GREATER_THAN","GREATER_THAN_OR_EQUAL","NULL","NOT_NULL"];var g=["EQUAL","NOT_EQUAL"];var f=new Array();var m=new Array();this.evaluate=function(t){var r=true;for(var s=0;s<f.length;s++){var q=f[s].evaluate(t);if(s==0){r=q}else{if(m[s]==e||m[s]=="or"){r=r||q}else{r=r&&q}}}return r};this.getfilterscount=function(){return f.length};this.setoperatorsbyfiltertype=function(q,r){switch(q){case"numericfilter":n=r;break;case"stringfilter":l=r;break;case"datefilter":o=r;break;case"booleanfilter":g=r;break}};this.getoperatorsbyfiltertype=function(q){var r=new Array();switch(q){case"numericfilter":r=n.slice(0);break;case"stringfilter":r=l.slice(0);break;case"datefilter":r=o.slice(0);break;case"booleanfilter":r=g.slice(0);break}return r};var k=function(){var q=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(q()+"-"+q()+"-"+q())};this.createfilter=function(u,r,t,s,q,v){if(u==null||u==undefined){return null}switch(u){case"numericfilter":return new j(r,t.toUpperCase());case"stringfilter":return new p(r,t.toUpperCase());case"datefilter":return new c(r,t.toUpperCase(),q,v);case"booleanfilter":return new d(r,t.toUpperCase());case"custom":return new b(r,t.toUpperCase(),s)}return null};this.getfilters=function(){var q=new Array();for(var r=0;r<f.length;r++){var s={value:f[r].filtervalue,condition:f[r].comparisonoperator,operator:m[r],type:f[r].type};q[r]=s}return q};this.addfilter=function(q,r){f[f.length]=r;r.key=k();m[m.length]=q};this.removefilter=function(r){for(var q=0;q<f.length;q++){if(f[q].key==r.key){f.splice(q,1);m.splice(q,1);break}}};this.getoperatorat=function(q){if(q==undefined||q==null){return null}if(q<0||q>f.length){return null}return m[q]};this.setoperatorat=function(r,q){if(r==undefined||r==null){return null}if(r<0||r>f.length){return null}m[q]=q};this.getfilterat=function(q){if(q==undefined||q==null){return null}if(q<0||q>f.length){return null}return f[q]};this.setfilterat=function(q,r){if(q==undefined||q==null){return null}if(q<0||q>f.length){return null}r.key=k();f[q]=r};this.clear=function(){f=new Array();m=new Array()};var p=function(r,q){this.filtervalue=r;this.comparisonoperator=q;this.type="stringfilter";this.evaluate=function(v){var u=this.filtervalue;var s=this.comparisonoperator;if(v==null||v==undefined){if(s=="NULL"){return true}return false}var w="";try{w=v.toString()}catch(t){return true}switch(s){case"EQUAL":return a.jqx.string.equalsIgnoreCase(w,u);case"EQUAL_CASE_SENSITIVE":return a.jqx.string.equals(w,u);case"NOT_EQUAL":return !a.jqx.string.equalsIgnoreCase(w,u);case"NOT_EQUAL_CASE_SENSITIVE":return !a.jqx.string.equals(w,u);case"CONTAINS":return a.jqx.string.containsIgnoreCase(w,u);case"CONTAINS_CASE_SENSITIVE":return a.jqx.string.contains(w,u);case"DOES_NOT_CONTAIN":return !a.jqx.string.containsIgnoreCase(w,u);case"DOES_NOT_CONTAIN_CASE_SENSITIVE":return !a.jqx.string.contains(w,u);case"EMPTY":return w=="";case"NOT_EMPTY":return w!="";case"NOT_NULL":return w!=null;case"STARTS_WITH":return a.jqx.string.startsWithIgnoreCase(w,u);case"ENDS_WITH":return a.jqx.string.endsWithIgnoreCase(w,u);case"ENDS_WITH_CASE_SENSITIVE":return a.jqx.string.endsWith(w,u);case"STARTS_WITH_CASE_SENSITIVE":return a.jqx.string.startsWith(w,u);default:return false}}};var d=function(r,q){this.filtervalue=r;this.comparisonoperator=q;this.type="booleanfilter";this.evaluate=function(u){var t=this.filtervalue;var s=this.comparisonoperator;if(u==null||u==undefined){if(s=="NULL"){return true}return false}var v=u;switch(s){case"EQUAL":return v==t||v.toString()==t.toString();case"NOT_EQUAL":return v!=t&&v.toString()!=t.toString();default:return false}}};var j=function(r,q){this.filtervalue=r;this.comparisonoperator=q;this.type="numericfilter";this.evaluate=function(v){var u=this.filtervalue;var s=this.comparisonoperator;if(v==null||v==undefined){if(s=="NOT_NULL"){return false}if(s=="NULL"){return true}else{return false}}else{if(s=="NULL"){return false}if(s=="NOT_NULL"){return true}}var w=v;try{w=parseFloat(w)}catch(t){if(v.toString()!=""){return false}}switch(s){case"EQUAL":return w==u;case"NOT_EQUAL":return w!=u;case"GREATER_THAN":return w>u;case"GREATER_THAN_OR_EQUAL":return w>=u;case"LESS_THAN":return w<u;case"LESS_THAN_OR_EQUAL":return w<=u;default:return true}}};var c=function(t,r,s,w){this.filtervalue=t;this.type="datefilter";if(s!=undefined&&w!=undefined){var u=a.jqx.dataFormat.parsedate(t,s,w);if(u!=null){this.filterdate=u}else{var q=a.jqx.dataFormat.tryparsedate(t,w);if(q!=null){this.filterdate=q}}}else{var v=new Date(t);if(v.toString()=="NaN"||v.toString()=="Invalid Date"){this.filterdate=a.jqx.dataFormat.tryparsedate(t)}else{this.filterdate=v}}this.comparisonoperator=r;this.evaluate=function(E){var F=this.filtervalue;var C=this.comparisonoperator;if(E==null||E==undefined){if(C=="NOT_NULL"){return false}if(C=="NULL"){return true}else{return false}}else{if(C=="NULL"){return false}if(C=="NOT_NULL"){return true}}var x=new Date();x.setFullYear(1900,0,1);x.setHours(12,0,0,0);try{var A=new Date(E);if(A.toString()=="NaN"||A.toString()=="Invalid Date"){E=a.jqx.dataFormat.tryparsedate(E)}else{E=A}x=E}catch(B){if(E.toString()!=""){return false}}if(this.filterdate!=null){F=this.filterdate}else{if(F.indexOf(":")!=-1||!isNaN(parseInt(F))){var D=new Date(x);D.setHours(12,0,0,0);var y=F.split(":");for(var z=0;z<y.length;z++){if(z==0){D.setHours(y[z])}if(z==1){D.setMinutes(y[z])}if(z==2){D.setSeconds(y[z])}}F=D}}if(x==null){x=""}switch(C){case"EQUAL":return x.toString()==F.toString();case"NOT_EQUAL":return x.toString()!=F.toString();case"GREATER_THAN":return x>F;case"GREATER_THAN_OR_EQUAL":return x>=F;case"LESS_THAN":return x<F;case"LESS_THAN_OR_EQUAL":return x<=F;default:return true}}};var b=function(r,q,s){this.filtervalue=r;this.comparisonoperator=q;this.evaluate=function(u,t){return s(this.filtervalue,u,this.comparisonoperator)}}}})(jQuery);